#include <stdio.h>#include <string.h>#include <stdlib.h>#include "def.h"#include "symbolTable.h"#define TRUE 1#define FALSE 0int DC;/*label data type. includes vars for label name, label type, if label is used as entry, address in memory,pointer to operandNode list which contains all operands' IC values that are using this label (in use only for external labels)*/typedef struct {	char name[MAX_LBL_SZ + 1]; /* because there is '/0' in the end */	unsigned int isData: 1;	unsigned int isCode: 1;	unsigned int isEntry: 1;	unsigned int isExtern: 1;	int value;} symbol;typedef struct symbolNode {	symbol data;	struct symbolNode *next;} symbolNode;/* pointer for the symbol table (point on node in the table) */static symbolNode *head = NULL;symbol *symbolInTable(char *label) {	symbolNode *ptr = head;	/* scan the table and compare the label to the previous labels */	while (ptr != NULL) {		if (!strcmp(label, ptr->data.name))			return &(ptr->data);		ptr = ptr->next;	}	return NULL; /* symbol is not in table */}int addSymbol(char *label, int guide, int IC, int DC) {	symbolNode *newNode = (symbolNode*) malloc(sizeof(symbolNode));	symbol data;	/* check if symbol is already in the table */	if (symbolInTable(label)) {		printf("error in %d: label is already defined\n", lineNumber);		return -1; /* error code */	}	/* create new node */	strcpy(data.name, label);	data.isData = ((guide == DATA) || (guide == STR));	data.isEntry = (guide == ENTRY);	data.isExtern = (guide == EXTERN);	data.isCode = ((guide == ENTRY) || (guide == EXTERN) || (guide == CODE));	data.value = (data.isData) ? DC : ((data.isExtern) ? 0 : IC + MMRY_OFFSET);	newNode->data = data;	newNode->next = head;	head = newNode; /* add the label to be the first in the list (order doesn't matter) */	return 0; /* success code */}int getValue(char *label) {	symbol *S = symbolInTable(label);	if (S == NULL)		return -1; /* symbol is not in table */	return S->value;}int isSymbolExternal(char* label) {	symbol *S = symbolInTable(label);	if (S == NULL)		return -1; /* symbol is not in table */	return S->isExtern;}void updateDataLabels(int ICF) {	symbolNode *ptr = head;	/* add the offset for all data symbols */	while (ptr != NULL) {		if (ptr->data.isData)			ptr->data.value += ICF;		ptr = ptr->next;	}}int getValueFromSymbol(char *label) {	symbol *S = symbolInTable(label);	if (S == NULL)		return -1; /* symbol is not in table */	return S->value;}